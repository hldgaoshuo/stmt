syntax = "proto3";

package Object;

option go_package = "./";

// todo 目前这个包的代码，既是 IR，也是值系统

message Function {
  bytes code = 1;
  uint64 num_params = 2;
}

message Closure {
  Function function = 1;
}

message Object {
  uint64 ref_count = 1;
  oneof literal {
    int64 literal_int = 2;
    double literal_float = 3;
    bool literal_bool = 4;
    string literal_nil = 5;
    string literal_string = 6;
    Function literal_function = 7;
    Closure literal_closure = 8;
  }
}

message Chunk {
  Closure closure = 1;
  repeated Object constants = 2;
  uint64 globals_count = 3;
}